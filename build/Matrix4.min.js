/*!
*  @license Matrix4.js v0.1.1next
* (c) 2019 yelloxing git+https://github.com/yelloxing/Matrix4.js.git
* License: MIT
*/

!function(r,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t():r.Matrix4=t()}("undefined"!=typeof window?window:this,function(r){"use strict";var l=function(r){return"number"==typeof r},w=function(r,t){var n,e,o=[];for(n=0;n<4;n++)for(e=0;e<t.length/4;e++)o[4*e+n]=r[n]*t[4*e]+r[n+4]*t[4*e+1]+r[n+8]*t[4*e+2]+r[n+12]*t[4*e+3];return o},u=function(r){if(9==r.length)return r[0]*r[4]*r[8]-r[0]*r[7]*r[5]-r[3]*r[1]*r[8]+r[3]*r[7]*r[2]+r[6]*r[1]*r[5]-r[6]*r[4]*r[2];if(16==r.length)return r[0]*u([r[5],r[6],r[7],r[9],r[10],r[11],r[13],r[14],r[15]])-r[4]*u([r[1],r[2],r[3],r[9],r[10],r[11],r[13],r[14],r[15]])+r[8]*u([r[1],r[2],r[3],r[5],r[6],r[7],r[13],r[14],r[15]])-r[12]*u([r[1],r[2],r[3],r[5],r[6],r[7],r[9],r[10],r[11]]);throw new Error("Unsupported parameter!")},i=function(r){var t,n=[u([(t=r)[5],t[6],t[7],t[9],t[10],t[11],t[13],t[14],t[15]]),-u([t[4],t[6],t[7],t[8],t[10],t[11],t[12],t[14],t[15]]),u([t[4],t[5],t[7],t[8],t[8],t[11],t[12],t[13],t[15]]),-u([t[4],t[5],t[6],t[8],t[9],t[10],t[12],t[13],t[14]]),-u([t[1],t[2],t[3],t[9],t[10],t[11],t[13],t[14],t[15]]),u([t[0],t[2],t[3],t[8],t[10],t[11],t[12],t[14],t[15]]),-u([t[0],t[1],t[3],t[8],t[9],t[11],t[12],t[13],t[15]]),u([t[0],t[1],t[2],t[8],t[9],t[10],t[12],t[13],t[14]]),u([t[1],t[2],t[3],t[5],t[6],t[7],t[13],t[14],t[15]]),-u([t[0],t[2],t[3],t[4],t[6],t[7],t[12],t[14],t[15]]),u([t[0],t[1],t[3],t[4],t[5],t[7],t[12],t[13],t[15]]),-u([t[0],t[1],t[2],t[4],t[5],t[6],t[12],t[13],t[14]]),-u([t[1],t[2],t[3],t[5],t[6],t[7],t[9],t[10],t[11]]),u([t[0],t[2],t[3],t[4],t[6],t[7],t[8],t[10],t[11]]),-u([t[0],t[1],t[3],t[4],t[5],t[7],t[8],t[9],t[11]]),u([t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]])];return[n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],n[2],n[6],n[10],n[14],n[3],n[7],n[11],n[15]]};return function(r){var v=r||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],d={move:function(r,t,n,e){return v=w(function(r,t,n,e){e=e||0;var o=Math.sqrt(t*t+n*n+e*e);return[1,0,0,0,0,1,0,0,0,0,1,0,t*r/o,n*r/o,e*r/o,1]}(r,t,n,e),v),d},rotate:function(r,t,n,e,o,u,i){var f,a,c,s=function(r,t,n,e,o,u){if(l(r)&&l(t)){if(l(n)?l(e)&&l(o)&&l(u)||(e=r,o=t,u=n,n=t=r=0):(n=0,e=r,o=t,u=1),r==e&&t==o&&n==u)throw new Error("It's not a legitimate ray!");var i=Math.sqrt((e-r)*(e-r)+(o-t)*(o-t)),f=0!=i?(o-t)/i:1,a=0!=i?(e-r)/i:0,c=(e-r)*a+(o-t)*f,s=u-n,h=Math.sqrt(c*c+s*s),v=0!=h?s/h:1,d=0!=h?c/h:0;return[[f,v*a,a*d,0,-a,f*v,f*d,0,0,-d,v,0,t*a-r*f,n*d-r*a*v-t*f*v,-r*a*d-t*f*d-n*v,1],[f,-a,0,0,v*a,v*f,-d,0,a*d,f*d,v,0,r,t,n,1]]}throw new Error("a1 and b1 is required!")}(t,n,e,o,u,i);return v=w(w(w(s[1],(f=r,a=Math.sin(f),[c=Math.cos(f),a,0,0,-a,c,0,0,0,0,1,0,0,0,0,1])),s[0]),v),d},scale:function(r,t,n,e,o,u){var i,f,a,c,s,h;return v=w([i=r,0,0,0,0,f=t,0,0,0,0,a=n,0,(c=(c=e)||0)-c*i,(s=(s=o)||0)-s*f,(h=(h=u)||0)-h*a,1],v),d},multiply:function(r,t){return v=t?w(v,r):w(r,v),d},inverse:function(){return v=function(r){var t,n=i(r),e=u(r),o=[];if(0==e)throw new Error("This matrix is irreversible!");for(t=0;t<16;t++)o[t]=n[t]/e;return o}(v),d},use:function(r,t,n,e){var o=w(v,[r,t,n=n||0,e=e||1]);return o[0]=o[0].toFixed(7),o[1]=o[1].toFixed(7),o[2]=o[2].toFixed(7),o},value:function(){return v}};return d}});